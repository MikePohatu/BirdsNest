{
  "name": "active-directory",
  "displayname": "Active Directory",
  "reports": {
    "ad-deeppaths": {
      "displayname": "AD Deep Paths",
      "description": "Lists Active Directory groups that are part of 'Member Of' chains with 5 hops or more",
      "query": "MATCH p=(n:AD_Group)-[:AD_MEMBER_OF*5..]->(:AD_Group) WITH nodes(p) AS groups UNWIND groups as group RETURN DISTINCT group",
      "propertyfilters": [ "name", "dn", "description", "scope" ]
    },
    "ad-emptygroups": {
      "displayname": "AD Empty Groups",
      "description": "Lists Active Directory groups that contain no users or computers, either directly or indirectly",
      "query": "MATCH (n:AD_Group) where n.scope=0 RETURN n ORDER BY n.name",
      "propertyfilters": [ "name", "dn", "description" ]
    },
    "ad-grouploops": {
      "displayname": "AD Group Loops",
      "description": "Lists Active Directory groups that have membership loops back to themselves",
      "query": "MATCH p=(n:AD_Group)-[:AD_MEMBER_OF*]->(n) WITH nodes(p) as groups UNWIND groups as group RETURN DISTINCT group",
      "propertyfilters": [ "name", "dn", "description", "scope" ]
    }
  },
  "edgedatatypes": {
    "AD_MEMBER_OF": {}
  },
  "nodedatatypes": {
    "AD_Computer": {
      "properties": [
        { "name": "description" },
        { "name": "dn" },
        { "name": "domainid" },
        { "name": "id" },
        { "name": "info" },
        { "name": "lastscan" },
        { "name": "name" },
        { "name": "operatingsystem" },
        { "name": "operatingsystemversion" },
        { "name": "path" },
        { "name": "primarygroupid" },
        { "name": "samaccountname" },
        { "name": "state" }
      ],
      "default": "samaccountname",
      "icon": "fas fa-desktop"
    },
    "AD_Group": {
      "properties": [
        { "name": "description" },
        { "name": "dn" },
        { "name": "domainid" },
        { "name": "grouptype" },
        { "name": "id" },
        { "name": "info" },
        { "name": "lastscan" },
        { "name": "member_count" },
        { "name": "name" },
        { "name": "path" },
        { "name": "rid" },
        { "name": "samaccountname" }
      ],
      "default": "samaccountname",
      "subtype": "grouptype",
      "icon": "fas fa-user-friends"
    },
    "AD_User": {
      "properties": [
        { "name": "description" },
        { "name": "displayname" },
        { "name": "dn" },
        { "name": "domainid" },
        { "name": "id" },
        { "name": "info" },
        { "name": "lastscan" },
        { "name": "name" },
        { "name": "path" },
        { "name": "primarygroupid" },
        { "name": "samaccountname" },
        { "name": "state" },
        { "name": "userprincipalname" }
      ],
      "default": "samaccountname",
      "icon": "fas fa-user"
    },
    "AD_Object": {
      "properties": [
        { "name": "description" },
        { "name": "displayname" },
        { "name": "dn" },
        { "name": "domainid" },
        { "name": "grouptype" },
        { "name": "id" },
        { "name": "info" },
        { "name": "lastscan" },
        { "name": "member_count" },
        { "name": "name" },
        { "name": "operatingsystem" },
        { "name": "operatingsystemversion" },
        { "name": "path" },
        { "name": "primarygroupid" },
        { "name": "rid" },
        { "name": "samaccountname" },
        { "name": "state" },
        { "name": "userprincipalname" }
      ],
      "default": "samaccountname"
    },
    "AD_Deleted": {
      "description": "Objects that have been deleted from AD",
      "icon": "far fa-trash-alt"
    }
  }
}
