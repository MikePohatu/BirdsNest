{
  "name": "active-directory",
  "displayname": "Active Directory",
  "reports": {
    "ad-deeppaths": {
      "displayname": "AD Deep Paths",
      "description": "Lists Active Directory groups that are part of 'Member Of' chains with 5 hops or more",
      "query": "MATCH p=(n:AD_Group)-[:AD_MEMBER_OF*5..]->(:AD_Group) WITH nodes(p) AS groups UNWIND groups as group RETURN DISTINCT group",
      "propertyfilters": [ "name", "dn", "description", "scope" ]
    },
    "ad-emptygroups": {
      "displayname": "AD Empty Groups",
      "description": "Lists Active Directory groups that contain no users or computers, either directly or indirectly",
      "query": "MATCH (n:AD_Group) where n.scope=0 RETURN n ORDER BY n.name",
      "propertyfilters": [ "name", "dn", "description" ]
    },
    "ad-grouploops": {
      "displayname": "AD Group Loops",
      "description": "Lists Active Directory groups that have membership loops back to themselves",
      "query": "MATCH p=(n:AD_Group)-[:AD_MEMBER_OF*]->(n) WITH nodes(p) as groups UNWIND groups as group RETURN DISTINCT group",
      "propertyfilters": [ "name", "dn", "description", "scope" ]
    }
  },
  "edgedatatypes": {
    "AD_MEMBER_OF": {
      "displayname": "AD Member Of",
      "properties": {
        "domainid": {},
        "lastscan": {}
      }
    }
  },
  "nodedatatypes": {
    "AD_Computer": {
      "displayname": "AD Computer",
      "description": "Active Directory domain joined computer object",
      "properties": {
        "description": {},
        "dn": {},
        "domainid": {},
        "id": {},
        "info": {},
        "lastscan": {},
        "name": {},
        "operatingsystem": {},
        "operatingsystemversion": {},
        "path": {},
        "primarygroupid": {},
        "samaccountname": {},
        "state": {}
      },
      "default": "samaccountname",
      "icon": "fas fa-desktop"
    },
    "AD_Group": {
      "displayname": "AD Group",
      "description": "Active Directory group",
      "properties": {
        "description": {},
        "dn": {},
        "domainid": {},
        "grouptype": {},
        "id": {},
        "info": {},
        "lastscan": {},
        "member_count": {},
        "name": {},
        "path": {},
        "rid": {},
        "samaccountname": {},
        "scope": {
          "type": "number"
        }
      },
      "default": "samaccountname",
      "subtype": "grouptype",
      "icon": "fas fa-user-friends"
    },
    "AD_User": {
      "displayname": "AD User",
      "description": "Active Directory user account",
      "properties": {
        "description": {},
        "displayname": {},
        "dn": {},
        "domainid": {},
        "id": {},
        "info": {},
        "lastscan": {},
        "name": {},
        "path": {},
        "primarygroupid": {},
        "samaccountname": {},
        "state": {},
        "userprincipalname": {}
      },
      "default": "samaccountname",
      "icon": "fas fa-user"
    },
    "AD_Object": {
      "displayname": "AD Object",
      "description": "Active Directory object, which could be a user, group, or computer",
      "properties": {
        "description": {},
        "displayname": {},
        "dn": {},
        "domainid": {},
        "grouptype": {},
        "id": {},
        "info": {},
        "lastscan": {},
        "member_count": {},
        "name": {},
        "operatingsystem": {},
        "operatingsystemversion": {},
        "path": {},
        "primarygroupid": {},
        "rid": {},
        "samaccountname": {},
        "scope": {
          "type": "number"
        },
        "state": {},
        "userprincipalname": {}
      },
      "default": "samaccountname"
    },
    "AD_Deleted": {
      "displayname": "AD Deleted",
      "description": "AD objects that have been deleted.",
      "icon": "far fa-trash-alt"
    }
  }
}
