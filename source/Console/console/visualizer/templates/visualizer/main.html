{% extends "spa.html" %}
{% load staticfiles %}

{% block head %}
	
{% endblock %}

{% block content %}
		<link rel="stylesheet" type="text/css" href="{% static 'visualizer/css/main.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'visualizer/css/visualization.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui.min.css' %}">

    	<div id="pagewrapper">
			<div id="main">
				<div id="querybar" class="grid-x grid-padding-x">
					{% csrf_token %}
					<form id="sourceForm" class="small-12 medium-12 cell" type="POST" action="javascript:search()">
						<div class="grid-x grid-margin-x">
							<fieldset class="fieldset small-4 cell">
								<legend>Source</legend>
							
								<div class="input-group">
									<span class="input-group-label small-4">Type</span>
									<select id="sourceType" class="small-8 input-group-field" onchange="updateProps('source')">
										<option value="" disabled selected hidden></option>
										<option value="">*</option>
									</select>
								</div>
								<div class="input-group">
									<span class="input-group-label small-4">Where</span>
									<select id="sourceProp" class="small-8 input-group-field"></select>
								</div>									
								<div class="input-group">
									<span class="input-group-label small-4">Equals</span>
									<input type="text" id="sourceVal" placeholder="Value" class="small-8 input-group-field">
								</div>
							</fieldset>

							<fieldset class="fieldset small-4 cell">
								<legend>Relationship</legend>
							
								<div class="input-group">
									<span class="input-group-label small-3">Type</span>
									<select id="edgeType" class="small-9 input-group-field">
										<option value="" disabled selected hidden></option>
										<option value="">*</option>
									</select>
								</div>	

								<span class="">Path Length</span>
								<div class="input-group">	
									<div class="grid-x input-group-field">
										<div class="cell small-2">
											<input type="number" id="sliderMin">
										</div>
										<div class="cell small-8">
											<div class="slider" data-slider data-initial-start="0" data-initial-end="5" data-start="0" data-end="20">
												<span class="slider-handle" data-slider-handle role="slider" aria-controls="sliderMin"></span>
												<span class="slider-fill" data-slider-fill></span>
												<span class="slider-handle" data-slider-handle role="slider" aria-controls="sliderMax"></span>
											</div>
										</div>
										<div class="cell small-2">
											<input type="number" id="sliderMax">
										</div>
									</div>
								</div>	

								<div class="grid-x cell align-top">
									<span class="cell small-3 align-middle">Direction</span>
									<a class="cell small-1 text-left" href='javascript:toggleDir()' >
										<i id='dirIcon' class="fas fa-arrow-right" data-dir="R"></i>
									</a>
								</div>		
							</fieldset>

							<fieldset class="fieldset small-4 cell">
								<legend>Target</legend>
							
								<div class="input-group">
									<span class="input-group-label small-3">Type</span>
									<select id="targetType" class="small-9 input-group-field" onchange="updateProps('target')">
										<option value="" disabled selected hidden></option>
										<option value="">*</option>
									</select>
								</div>
								<div class="input-group">
									<span class="input-group-label small-3">Where</span>
									<select id="targetProp" class="small-9 input-group-field"></select>
								</div>									
								<div class="input-group">
									<span class="input-group-label small-3">Equals</span>
									<input type="text" id="targetVal" placeholder="Value" class="small-9 input-group-field">
								</div>
							</fieldset>
						</div>
						<div class="grid-x cell align-middle">
							<div class="cell small-3 medium-1">
								<input type="submit" class="button" value="Search">
							</div>
							<div class="cell small-7 medium-auto">
								<p id="searchNotification"></p>
							</div>
							<div class="cell small-2 text-right">
								<p><a href='javascript:resetView()'>Clear view</a></p>
							</div>
						</div>
					</form>
					
				</div>
				
				<div id="drawingpane" tabindex="0">
					<div id="viewcontrols">
						<div id="restartLayoutBtn">
							<i id="restartIcon" class="fas fa-sync-alt viewcontrol" data-tooltip tabindex="1" title="Refresh layout"></i>
						</div>
						<div id="pausePlayBtn">
							<i id="pausePlayIcon" class="fas fa-play viewcontrol" data-tooltip tabindex="1" title="Play/pause layout"></i>
						</div>
						<div id="removeBtn">
							<i id="removeIcon" class="fas fa-trash-alt viewcontrol" data-tooltip tabindex="1" title="Remove node"></i>
						</div>
						<div id="menuShowHideButton">
							<i id="menuIcon" class="fas fa-angle-up viewcontrol viewcontrol-right"></i>
						</div>
					</div>
				</div>

				<div id="detailcardwrapper"></div>
			</div>
		</div>
		
		<!--<a href="#" data-reveal-id="myModal">Click Me For A Modal</a>

		<div id="confirmModal" class="reveal-modal" data-reveal aria-labelledby="confirmModal" aria-hidden="true" role="dialog">
			<h2 id="confirmModalTitle"></h2>
			<p class="lead">Your couch.  It is mine.</p>
			<p>I'm a cool paragraph that lives inside of an even cooler modal. Wins!</p>
			<a class="close-reveal-modal" aria-label="Close">&#215;</a>
		</div>-->
{% endblock %}

{% block tail %}	
	<script defer src="{% static 'js/vendor/fontawesome/all.js' %}" type="text/javascript"></script>
	<script src="{% static 'visualizer/js/d3.min.js' %}"></script>
	<script src="{% static 'js/vendor/jquery-ui.min.js' %}"></script>
	<script src="{% static 'visualizer/js/visualizer.js' %}" type="text/javascript"></script>
	<script>
		//var getAllUrl = "{% static 'visualizer/json/testdata.json' %}";
		//var getAllUrl = "/api/getall";
		var iconmappings;
		$.getJSON("{% static 'visualizer/json/labelicons.json' %}", function(data) {
		        iconmappings = new IconMappings(data);
		    });
		$.getJSON("/api/nodes/labels", function(data) {
		        for (var i = 0; i < data.length; ++i) {
					addOption(document.getElementById("sourceType"), data[i], data[i])
				}
				for (var i = 0; i < data.length; ++i) {
					addOption(document.getElementById("targetType"), data[i], data[i])
				}
		    });
		$.getJSON("/api/edges/labels", function(data) {
		        for (var i = 0; i < data.length; ++i) {
					addOption(document.getElementById("edgeType"), data[i], data[i])
				}
		    });
		
		$("#menuShowHideButton").click(function(){
			var icon = $("#menuIcon");
			if(icon.hasClass("fa-angle-up")) { 
				icon.removeClass("fa-angle-up"); 
				icon.addClass("fa-angle-down"); 
			}
			else{ 
				icon.removeClass("fa-angle-down"); 
				icon.addClass("fa-angle-up"); 
			}
			$("#querybar").slideToggle();
		});

		drawGraph('drawingpane');
	</script>
{% endblock %}